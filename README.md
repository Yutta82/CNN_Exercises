# 这是一个卷积神经网络的练习库
目前有两个项目：
1. 基于TensorFlow框架与[Chest X-Ray Images (Pneumonia)数据集](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia)的肺炎诊断

   关于模型：
   1. 选择VGG作为baseline，针对二分类任务进行定制。既保留了VGG的深度结构，又通过现代技术提高了效率和性能。
   2. 引入深度可分离卷积(SeparableConv2D层)，提高计算效率，减少参数量。
   3. 引入批归一化(BatchNormalization层)，加速训练，稳定输出。
   4. 添加具有合理数量神经元的密集层。以更高的学习率进行训练，并试验密集层中的神经元数量。也针对网络深度进行此操作。
   5. 一旦知道了较好的深度，就开始以较低的学习率和衰减来训练网络。
   
   网络结构
   ```text
   _________________________________________________________________
   Layer (type)                 Output Shape              Param #   
   =================================================================
   ImageInput (InputLayer)      (None, 224, 224, 3)       0         
   _________________________________________________________________
   Conv1_1 (Conv2D)             (None, 224, 224, 64)      1792      
   _________________________________________________________________
   Conv1_2 (Conv2D)             (None, 224, 224, 64)      36928     
   _________________________________________________________________
   pool1 (MaxPooling2D)         (None, 112, 112, 64)      0         
   _________________________________________________________________
   Conv2_1 (SeparableConv2D)    (None, 112, 112, 128)     8896      
   _________________________________________________________________
   Conv2_2 (SeparableConv2D)    (None, 112, 112, 128)     17664     
   _________________________________________________________________
   pool2 (MaxPooling2D)         (None, 56, 56, 128)       0         
   _________________________________________________________________
   Conv3_1 (SeparableConv2D)    (None, 56, 56, 256)       34176     
   _________________________________________________________________
   bn1 (BatchNormalization)     (None, 56, 56, 256)       1024      
   _________________________________________________________________
   Conv3_2 (SeparableConv2D)    (None, 56, 56, 256)       68096     
   _________________________________________________________________
   bn2 (BatchNormalization)     (None, 56, 56, 256)       1024      
   _________________________________________________________________
   Conv3_3 (SeparableConv2D)    (None, 56, 56, 256)       68096     
   _________________________________________________________________
   pool3 (MaxPooling2D)         (None, 28, 28, 256)       0         
   _________________________________________________________________
   Conv4_1 (SeparableConv2D)    (None, 28, 28, 512)       133888    
   _________________________________________________________________
   bn3 (BatchNormalization)     (None, 28, 28, 512)       2048      
   _________________________________________________________________
   Conv4_2 (SeparableConv2D)    (None, 28, 28, 512)       267264    
   _________________________________________________________________
   bn4 (BatchNormalization)     (None, 28, 28, 512)       2048      
   _________________________________________________________________
   Conv4_3 (SeparableConv2D)    (None, 28, 28, 512)       267264    
   _________________________________________________________________
   pool4 (MaxPooling2D)         (None, 14, 14, 512)       0         
   _________________________________________________________________
   flatten (Flatten)            (None, 100352)            0         
   _________________________________________________________________
   fc1 (Dense)                  (None, 1024)              102761472 
   _________________________________________________________________
   dropout1 (Dropout)           (None, 1024)              0         
   _________________________________________________________________
   fc2 (Dense)                  (None, 512)               524800    
   _________________________________________________________________
   dropout2 (Dropout)           (None, 512)               0         
   _________________________________________________________________
   fc3 (Dense)                  (None, 2)                 1026      
   =================================================================
   Total params: 104,197,506
   Trainable params: 104,194,434
   Non-trainable params: 3,072
   _________________________________________________________________ 
   ```

2. 基于TensorFlow框架与[中科院自动化研究所的手写汉字数据集](http://www.nlpr.ia.ac.cn/databases/download/feature_data/HWDB1.1trn_gnt.zip)的手写汉字识别
   
   网络结构：
   ```text
   _________________________________________________________________
    Layer (type)                Output Shape              Param #   
   =================================================================
    input_1 (InputLayer)        [(None, 64, 64, 1)]       0         
                                                                    
    conv2d (Conv2D)             (None, 64, 64, 64)        640       
                                                                    
    max_pooling2d (MaxPooling2D  (None, 32, 32, 64)       0         
    )                                                               
                                                                    
    conv2d_1 (Conv2D)           (None, 32, 32, 128)       73856     
                                                                    
    max_pooling2d_1 (MaxPooling  (None, 16, 16, 128)      0         
    2D)                                                             
                                                                    
    conv2d_2 (Conv2D)           (None, 16, 16, 256)       295168    
                                                                    
    max_pooling2d_2 (MaxPooling  (None, 8, 8, 256)        0         
    2D)                                                             
                                                                    
    flatten (Flatten)           (None, 16384)             0         
                                                                    
    dropout (Dropout)           (None, 16384)             0         
                                                                    
    dense (Dense)               (None, 1024)              16778240  
                                                                    
    dropout_1 (Dropout)         (None, 1024)              0         
                                                                    
    dense_1 (Dense)             (None, 3755)              3854340   
                                                                    
   =================================================================
   Total params: 20,935,244
   Trainable params: 20,935,244
   Non-trainable params: 0
   _________________________________________________________________
   ```
   
3. 基于TensorFlow框架与[ISBI Challenge: Segmentation of neuronal structures in EM stacks.](http://brainiac2.mit.edu/isbi_challenge/)的神经元结构分割
   
   关于模型：
   1. 选择u-net作为baseline

   网络结构
   ```text
   ┌─────────────────────┬───────────────────┬────────────┬───────────────────┐
   │ Layer (type)        │ Output Shape      │    Param # │ Connected to      │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ input_layer         │ (None, 256, 256,  │          0 │ -                 │
   │ (InputLayer)        │ 1)                │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d (Conv2D)     │ (None, 256, 256,  │        640 │ input_layer[0][0] │
   │                     │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalization │ (None, 256, 256,  │        256 │ conv2d[0][0]      │
   │ (BatchNormalizatio… │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_1 (Conv2D)   │ (None, 256, 256,  │     36,928 │ batch_normalizat… │
   │                     │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
   │ (MaxPooling2D)      │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout (Dropout)   │ (None, 128, 128,  │          0 │ max_pooling2d[0]… │
   │                     │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     73,856 │ dropout[0][0]     │
   │                     │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 128, 128,  │        512 │ conv2d_2[0][0]    │
   │ (BatchNormalizatio… │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_3 (Conv2D)   │ (None, 128, 128,  │    147,584 │ batch_normalizat… │
   │                     │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
   │ (MaxPooling2D)      │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_1 (Dropout) │ (None, 64, 64,    │          0 │ max_pooling2d_1[… │
   │                     │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_4 (Conv2D)   │ (None, 64, 64,    │    295,168 │ dropout_1[0][0]   │
   │                     │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 64, 64,    │      1,024 │ conv2d_4[0][0]    │
   │ (BatchNormalizatio… │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    590,080 │ batch_normalizat… │
   │                     │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ max_pooling2d_2     │ (None, 32, 32,    │          0 │ conv2d_5[0][0]    │
   │ (MaxPooling2D)      │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_2 (Dropout) │ (None, 32, 32,    │          0 │ max_pooling2d_2[… │
   │                     │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_6 (Conv2D)   │ (None, 32, 32,    │  1,180,160 │ dropout_2[0][0]   │
   │                     │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 32, 32,    │      2,048 │ conv2d_6[0][0]    │
   │ (BatchNormalizatio… │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_7 (Conv2D)   │ (None, 32, 32,    │  2,359,808 │ batch_normalizat… │
   │                     │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ max_pooling2d_3     │ (None, 16, 16,    │          0 │ conv2d_7[0][0]    │
   │ (MaxPooling2D)      │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_3 (Dropout) │ (None, 16, 16,    │          0 │ max_pooling2d_3[… │
   │                     │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_8 (Conv2D)   │ (None, 16, 16,    │  4,719,616 │ dropout_3[0][0]   │
   │                     │ 1024)             │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 16, 16,    │      4,096 │ conv2d_8[0][0]    │
   │ (BatchNormalizatio… │ 1024)             │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_9 (Conv2D)   │ (None, 16, 16,    │  9,438,208 │ batch_normalizat… │
   │                     │ 1024)             │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_transpose    │ (None, 32, 32,    │  4,719,104 │ conv2d_9[0][0]    │
   │ (Conv2DTranspose)   │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ concatenate         │ (None, 32, 32,    │          0 │ conv2d_7[0][0],   │
   │ (Concatenate)       │ 1024)             │            │ conv2d_transpose… │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_4 (Dropout) │ (None, 32, 32,    │          0 │ concatenate[0][0] │
   │                     │ 1024)             │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_10 (Conv2D)  │ (None, 32, 32,    │  4,719,104 │ dropout_4[0][0]   │
   │                     │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 32, 32,    │      2,048 │ conv2d_10[0][0]   │
   │ (BatchNormalizatio… │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_11 (Conv2D)  │ (None, 32, 32,    │  2,359,808 │ batch_normalizat… │
   │                     │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_transpose_1  │ (None, 64, 64,    │  1,179,904 │ conv2d_11[0][0]   │
   │ (Conv2DTranspose)   │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ concatenate_1       │ (None, 64, 64,    │          0 │ conv2d_5[0][0],   │
   │ (Concatenate)       │ 512)              │            │ conv2d_transpose… │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_5 (Dropout) │ (None, 64, 64,    │          0 │ concatenate_1[0]… │
   │                     │ 512)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_12 (Conv2D)  │ (None, 64, 64,    │  1,179,904 │ dropout_5[0][0]   │
   │                     │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 64, 64,    │      1,024 │ conv2d_12[0][0]   │
   │ (BatchNormalizatio… │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_13 (Conv2D)  │ (None, 64, 64,    │    590,080 │ batch_normalizat… │
   │                     │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_transpose_2  │ (None, 128, 128,  │    295,040 │ conv2d_13[0][0]   │
   │ (Conv2DTranspose)   │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ concatenate_2       │ (None, 128, 128,  │          0 │ conv2d_3[0][0],   │
   │ (Concatenate)       │ 256)              │            │ conv2d_transpose… │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_6 (Dropout) │ (None, 128, 128,  │          0 │ concatenate_2[0]… │
   │                     │ 256)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_14 (Conv2D)  │ (None, 128, 128,  │    295,040 │ dropout_6[0][0]   │
   │                     │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 128, 128,  │        512 │ conv2d_14[0][0]   │
   │ (BatchNormalizatio… │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_15 (Conv2D)  │ (None, 128, 128,  │    147,584 │ batch_normalizat… │
   │                     │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_transpose_3  │ (None, 256, 256,  │     73,792 │ conv2d_15[0][0]   │
   │ (Conv2DTranspose)   │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ concatenate_3       │ (None, 256, 256,  │          0 │ conv2d_1[0][0],   │
   │ (Concatenate)       │ 128)              │            │ conv2d_transpose… │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ dropout_7 (Dropout) │ (None, 256, 256,  │          0 │ concatenate_3[0]… │
   │                     │ 128)              │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_16 (Conv2D)  │ (None, 256, 256,  │     73,792 │ dropout_7[0][0]   │
   │                     │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ batch_normalizatio… │ (None, 256, 256,  │        256 │ conv2d_16[0][0]   │
   │ (BatchNormalizatio… │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_17 (Conv2D)  │ (None, 256, 256,  │     36,928 │ batch_normalizat… │
   │                     │ 64)               │            │                   │
   ├─────────────────────┼───────────────────┼────────────┼───────────────────┤
   │ conv2d_18 (Conv2D)  │ (None, 256, 256,  │         65 │ conv2d_17[0][0]   │
   │                     │ 1)                │            │                   │
   └─────────────────────┴───────────────────┴────────────┴───────────────────┘
    Total params: 34,523,969 (131.70 MB)
    Trainable params: 34,518,081 (131.68 MB)
    Non-trainable params: 5,888 (23.00 KB)

   ```   